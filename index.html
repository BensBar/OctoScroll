<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Octoscroll Slideshow</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      width: 100vw;
      background-color: var(--bg-color, #f5f5f5);
      transition: background 0.2s;
    }
    .container {
      width: 100vw;
      height: 100vh;
      background: none;
      margin: 0;
      padding: 0;
      border-radius: 0;
      box-shadow: none;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      position: relative;
    }
    .octocat-card {
      background: none;
      border: none;
      box-shadow: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100vw;
      height: 100vh;
      padding: 0;
      margin: 0;
    }
    .octocat-card img {
      max-width: 100vw;
      max-height: 100vh;
      width: auto;
      height: auto;
      display: block;
      margin: 0 auto;
      border-radius: 0;
      background: none;
      transition: box-shadow 0.3s;
      cursor: pointer;
      box-shadow: 0 0 24px rgba(0,0,0,0.35);
    }
    .octocat-name,
    .octocat-description {
      display: none;
    }
    .octocat-description.shown,
    .octocat-name.shown {
      display: block;
      color: var(--desc-color, #fff);
      background: rgba(0,0,0,0.6);
      padding: 0.5em 1em;
      border-radius: 8px;
      font-size: 1.2em;
      margin-top: 0.5em;
      text-align: center;
      position: absolute;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      max-width: 90vw;
      word-break: break-word;
    }
    .slideshow-controls,
    .slide-count {
      display: none;
    }
    /* Fullscreen styles */
    .fullscreen-bg {
      background: var(--bg-color, #000) !important;
    }
    .fullscreen-img {
      width: 100vw !important;
      height: 100vh !important;
      object-fit: contain !important;
      margin: 0 !important;
      border-radius: 0 !important;
      background: none !important;
      display: block;
    }
    /* Dark mode */
    body.dark {
      --bg-color: #181a1b;
      --desc-color: #fff;
      background: #181a1b;
    }
    .dark .octocat-description.shown,
    .dark .octocat-name.shown {
      color: #fff;
      background: rgba(0,0,0,0.75);
    }
    .dark .fullscreen-bg {
      background: #181a1b !important;
    }
    /* Dark mode toggle button */
    #darkmode-toggle {
      position: absolute;
      top: 18px;
      right: 20px;
      padding: 10px 18px;
      background: #333;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      opacity: 0.7;
      z-index: 100;
      transition: background 0.2s, opacity 0.2s;
      user-select: none;
    }
    #darkmode-toggle:hover {
      background: #111;
      opacity: 1;
    }
    /* Hide toggle in fullscreen API mode */
    .hide-toggle #darkmode-toggle {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container" id="container">
    <button id="darkmode-toggle">üåô</button>
    <div class="octocat-slide" id="octocat-slide">
      <!-- Octocat will appear here -->
    </div>
  </div>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const octocatSlide = document.getElementById('octocat-slide');
  const container = document.getElementById('container');
  const darkmodeToggle = document.getElementById('darkmode-toggle');
  let octocats = [];
  let currentIndex = 0;
  let intervalId = null;
  let isPaused = false;
  let isFullscreen = false;
  let darkMode = false;

  // Dark mode initial state from system preferences
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    enableDarkMode();
  }
  // Restore dark mode from localStorage
  if (localStorage.getItem('octoscroll_dark') === '1') enableDarkMode();

  fetch('octocats.json')
    .then(response => response.json())
    .then(data => {
      octocats = data.map(o => ({
        name: o.name,
        image: o.url.replace('//images/', '/images/'),
        description: `Created by ${o.author}`
      }));
      renderCurrentOctocat();
      startAutoscroll();
    })
    .catch(error => {
      octocatSlide.innerHTML = '<p style="color:#c00;">Could not load Octocats.</p>';
      console.error(error);
    });

  function renderCurrentOctocat(showDescription = false) {
    if (octocats.length === 0) {
      octocatSlide.innerHTML = '';
      return;
    }
    const o = octocats[currentIndex];
    octocatSlide.innerHTML = `
      <div class="octocat-card" id="octocat-card">
        <img src="${o.image}" alt="${o.name}" id="octocat-img">
        <div class="octocat-description${showDescription && !isFullscreen ? ' shown' : ''}" id="octocat-desc">${o.description}</div>
      </div>
    `;
    const img = document.getElementById('octocat-img');
    if (isFullscreen) {
      img.classList.add('fullscreen-img');
      container.classList.add('fullscreen-bg', 'hide-toggle');
      document.body.classList.add('hide-toggle');
    } else {
      img.classList.remove('fullscreen-img');
      container.classList.remove('fullscreen-bg', 'hide-toggle');
      document.body.classList.remove('hide-toggle');
    }
    img.addEventListener('click', handleImageClick);
    img.addEventListener('touchstart', function(e) { e.preventDefault(); handleImageClick(); });
  }

  function startAutoscroll() {
    if (intervalId) clearInterval(intervalId);
    intervalId = setInterval(() => {
      if (!isPaused && octocats.length > 0) {
        currentIndex = (currentIndex + 1) % octocats.length;
        renderCurrentOctocat(false);
      }
    }, 1000);
  }

  function stopAutoscroll() {
    if (intervalId) clearInterval(intervalId);
    intervalId = null;
  }

  function handleImageClick() {
    if (!isPaused && !isFullscreen) {
      // Pause and show description
      isPaused = true;
      stopAutoscroll();
      renderCurrentOctocat(true);
      return;
    }
    if (isPaused && !isFullscreen) {
      // Enter fullscreen mode
      enterFullscreen();
      return;
    }
    if (isPaused && isFullscreen) {
      // Exit fullscreen
      exitFullscreen();
      return;
    }
  }

  function enterFullscreen() {
    isFullscreen = true;
    if (container.requestFullscreen) container.requestFullscreen();
    else if (container.webkitRequestFullscreen) container.webkitRequestFullscreen();
    else if (container.msRequestFullscreen) container.msRequestFullscreen();
    renderCurrentOctocat(true);
  }

  function exitFullscreen() {
    isFullscreen = false;
    if (document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
      if (document.exitFullscreen) document.exitFullscreen();
      else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
      else if (document.msExitFullscreen) document.msExitFullscreen();
    }
    renderCurrentOctocat(true);
  }

  document.addEventListener('fullscreenchange', function() {
    if (!document.fullscreenElement) {
      isFullscreen = false;
      renderCurrentOctocat(true);
    }
  });
  document.addEventListener('webkitfullscreenchange', function() {
    if (!document.webkitFullscreenElement) {
      isFullscreen = false;
      renderCurrentOctocat(true);
    }
  });
  document.addEventListener('msfullscreenchange', function() {
    if (!document.msFullscreenElement) {
      isFullscreen = false;
      renderCurrentOctocat(true);
    }
  });

  // Dark mode toggle logic
  function enableDarkMode() {
    document.body.classList.add('dark');
    darkMode = true;
    darkmodeToggle.textContent = '‚òÄÔ∏è';
    localStorage.setItem('octoscroll_dark', '1');
  }
  function disableDarkMode() {
    document.body.classList.remove('dark');
    darkMode = false;
    darkmodeToggle.textContent = 'üåô';
    localStorage.setItem('octoscroll_dark', '0');
  }
  darkmodeToggle.addEventListener('click', function() {
    if (darkMode) disableDarkMode();
    else enableDarkMode();
  });

  // Keyboard navigation for accessibility (optional)
  document.addEventListener('keydown', function(e) {
    if (octocats.length === 0) return;
    if (e.key === 'ArrowLeft') {
      currentIndex = (currentIndex - 1 + octocats.length) % octocats.length;
      renderCurrentOctocat(isPaused && !isFullscreen);
    }
    if (e.key === 'ArrowRight') {
      currentIndex = (currentIndex + 1) % octocats.length;
      renderCurrentOctocat(isPaused && !isFullscreen);
    }
    if (e.key === ' ') { // Space to pause/resume
      e.preventDefault();
      if (!isPaused) {
        isPaused = true;
        stopAutoscroll();
        renderCurrentOctocat(true);
      } else {
        isPaused = false;
        renderCurrentOctocat(false);
        startAutoscroll();
      }
    }
    if (e.key === 'f') { // 'f' for fullscreen when paused
      if (isPaused && !isFullscreen) enterFullscreen();
    }
    if (e.key === 'Escape' && isFullscreen) {
      exitFullscreen();
    }
    if (e.key === 'd') { // 'd' for dark mode toggle
      if (darkMode) disableDarkMode();
      else enableDarkMode();
    }
  });
});
</script>
</body>
</html>
